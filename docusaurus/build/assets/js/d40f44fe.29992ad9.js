"use strict";(globalThis.webpackChunkai_textbook_docusaurus=globalThis.webpackChunkai_textbook_docusaurus||[]).push([[818],{5789:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>c,toc:()=>a});var i=n(4848),r=n(8453);const t={sidebar_position:2,title:"ROS 2 Nodes, Topics, and Services"},o="ROS 2 Nodes, Topics, and Services",c={id:"module-1-ros2/nodes-topics-services",title:"ROS 2 Nodes, Topics, and Services",description:"In ROS 2, nodes communicate through a publish-subscribe model using topics, services, and actions. Understanding these communication patterns is essential for building distributed robotic systems.",source:"@site/docs/module-1-ros2/nodes-topics-services.md",sourceDirName:"module-1-ros2",slug:"/module-1-ros2/nodes-topics-services",permalink:"/Physical-AI-Humanoid-Robotic-Text-Book/docs/module-1-ros2/nodes-topics-services",draft:!1,unlisted:!1,editUrl:"https://github.com/Abdullahkhan90/physical-ai-humanoid-robotic-text-book/edit/main/docs/module-1-ros2/nodes-topics-services.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"ROS 2 Nodes, Topics, and Services"},sidebar:"tutorialSidebar",previous:{title:"Introduction to ROS 2",permalink:"/Physical-AI-Humanoid-Robotic-Text-Book/docs/module-1-ros2/intro"},next:{title:"Integrating Python Agents with ROS Controllers",permalink:"/Physical-AI-Humanoid-Robotic-Text-Book/docs/module-1-ros2/integrating-python-agents"}},l={},a=[{value:"Nodes",id:"nodes",level:2},{value:"Creating a Node",id:"creating-a-node",level:3},{value:"Topics",id:"topics",level:2},{value:"Publisher Example",id:"publisher-example",level:3},{value:"Subscriber Example",id:"subscriber-example",level:3},{value:"Services",id:"services",level:2},{value:"Service Definition",id:"service-definition",level:3},{value:"Service Client Example",id:"service-client-example",level:3},{value:"Actions",id:"actions",level:2},{value:"Communication Patterns Comparison",id:"communication-patterns-comparison",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Summary",id:"summary",level:2},{value:"Exercises",id:"exercises",level:2}];function d(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h1,{id:"ros-2-nodes-topics-and-services",children:"ROS 2 Nodes, Topics, and Services"}),"\n",(0,i.jsx)(s.p,{children:"In ROS 2, nodes communicate through a publish-subscribe model using topics, services, and actions. Understanding these communication patterns is essential for building distributed robotic systems."}),"\n",(0,i.jsx)(s.h2,{id:"nodes",children:"Nodes"}),"\n",(0,i.jsx)(s.p,{children:"A node is a process that performs computation, and is the fundamental unit of a ROS 2 program. Multiple nodes are combined together to form a complete robot application. Nodes are designed to be modular, meaning that each node should have a specific task (e.g., controlling a wheel motor, reading sensor data, etc.)."}),"\n",(0,i.jsx)(s.p,{children:"Nodes in ROS 2 are designed to be lightweight, and the ROS graph (the network of nodes) can have many nodes connected at once. A node is a collection of one or more topics, services, and actions."}),"\n",(0,i.jsx)(s.h3,{id:"creating-a-node",children:"Creating a Node"}),"\n",(0,i.jsxs)(s.p,{children:["In Python, using the ",(0,i.jsx)(s.code,{children:"rclpy"})," client library:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\n\r\nclass MinimalPublisher(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('minimal_publisher')\r\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\r\n        timer_period = 0.5  # seconds\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = 'Hello World: %d' % self.i\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\r\n        self.i += 1\n"})}),"\n",(0,i.jsx)(s.h2,{id:"topics",children:"Topics"}),"\n",(0,i.jsx)(s.p,{children:"Topics enable asynchronous message passing between nodes using a publish-subscribe paradigm. A node publishes messages to a topic, and other nodes subscribe to that topic to receive the messages."}),"\n",(0,i.jsxs)(s.p,{children:["Topics in ROS 2 are type-checked, meaning all messages published to a topic must be of a specific type. Message types are defined using ",(0,i.jsx)(s.code,{children:".msg"})," files, which are compiled into language-specific code for Python, C++, and other supported languages."]}),"\n",(0,i.jsx)(s.h3,{id:"publisher-example",children:"Publisher Example"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy\r\nfrom std_msgs.msg import String\r\n\r\ndef publisher_member_function():\r\n    msg = String()\r\n    msg.data = 'Hello World'\r\n    \r\n    publisher.publish(msg)\n"})}),"\n",(0,i.jsx)(s.h3,{id:"subscriber-example",children:"Subscriber Example"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"class MinimalSubscriber(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('minimal_subscriber')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'topic',\r\n            self.listener_callback,\r\n            10)\r\n        self.subscription  # prevent unused variable warning\r\n\r\n    def listener_callback(self, msg):\r\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n"})}),"\n",(0,i.jsx)(s.h2,{id:"services",children:"Services"}),"\n",(0,i.jsx)(s.p,{children:"Services provide synchronous request-response communication between nodes. A service consists of two parts:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Request: Sent from the client to the server"}),"\n",(0,i.jsx)(s.li,{children:"Response: Sent from the server back to the client"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Services are used when you need to ensure that a response is returned from a node and you want to wait for that response."}),"\n",(0,i.jsx)(s.h3,{id:"service-definition",children:"Service Definition"}),"\n",(0,i.jsxs)(s.p,{children:["In a ",(0,i.jsx)(s.code,{children:".srv"})," file:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"# Request\r\nstring name\r\n---\r\n# Response\r\nbool success\r\nstring message\n"})}),"\n",(0,i.jsx)(s.h3,{id:"service-client-example",children:"Service Client Example"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy\r\nfrom example_interfaces.srv import AddTwoInts\r\n\r\ndef send_request():\r\n    request = AddTwoInts.Request()\r\n    request.a = 1\r\n    request.b = 2\r\n    future = cli.call_async(request)\r\n    rclpy.spin_until_future_complete(node, future)\r\n    return future.result()\n"})}),"\n",(0,i.jsx)(s.h2,{id:"actions",children:"Actions"}),"\n",(0,i.jsx)(s.p,{children:"Actions are another communication pattern, designed for long-running tasks that require feedback. Actions have three components:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Goal: Request sent to the action server"}),"\n",(0,i.jsx)(s.li,{children:"Result: Response sent from the action server"}),"\n",(0,i.jsx)(s.li,{children:"Feedback: Periodic updates sent from the action server during execution"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"communication-patterns-comparison",children:"Communication Patterns Comparison"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Pattern"}),(0,i.jsx)(s.th,{children:"Type"}),(0,i.jsx)(s.th,{children:"Use Case"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Topics"}),(0,i.jsx)(s.td,{children:"Asynchronous"}),(0,i.jsx)(s.td,{children:"Continuous data streams like sensor readings"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Services"}),(0,i.jsx)(s.td,{children:"Synchronous"}),(0,i.jsx)(s.td,{children:"Request-response like calculating a trajectory"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Actions"}),(0,i.jsx)(s.td,{children:"Synchronous with feedback"}),(0,i.jsx)(s.td,{children:"Long-running tasks like navigating to a location"})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Node Design"}),": Keep nodes focused on a single responsibility"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Topic Naming"}),": Use descriptive and consistent names"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Message Types"}),": Define clear message structures"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Error Handling"}),": Implement appropriate error handling for each communication pattern"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Resource Management"}),": Properly clean up publishers, subscribers, services, and clients"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(s.p,{children:"ROS 2's communication patterns provide the necessary tools for building distributed robotic systems. Understanding when to use each pattern is crucial for developing robust and maintainable robot applications."}),"\n",(0,i.jsx)(s.h2,{id:"exercises",children:"Exercises"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"Implement a publisher node that publishes velocity commands to a robot"}),"\n",(0,i.jsx)(s.li,{children:"Create a subscriber node that listens to sensor data and logs it"}),"\n",(0,i.jsx)(s.li,{children:"Design a service that calculates inverse kinematics solutions"}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["In the next section, we'll explore how to bridge Python-based AI agents with ROS controllers using ",(0,i.jsx)(s.code,{children:"rclpy"}),"."]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>c});var i=n(6540);const r={},t=i.createContext(r);function o(e){const s=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);